if(!(New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)){throw"Not running as Administrator"}$T=$ENV:TEMP;($U='https://github.com/microsoft/winget-cli/releases/download/v1.7.11132/ccfd1d114c9641fc8491f3c7c179829e_License1.xml','https://github.com/microsoft/microsoft-ui-xaml/releases/download/v2.8.6/Microsoft.UI.Xaml.2.8.x64.appx','https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx','https://aka.ms/getwinget')|ForEach{[Net.WebClient]::new().DownloadFile($_,("$T\$(Split-Path -Leaf $_)"))};@('license.xml','Microsoft.UI.Xaml.2.8.x64.appx','Microsoft.VCLibs.x64.14.00.Desktop.appx','getwinget')|%{if($_-eq'license.xml'){Add-AppxProvisionedPackage -Online -ErrorAction Inquire -PackagePath "$T\getwinget" -LicensePath "$T\$_"}else{Add-AppxPackage "$T\$_"};Remove-Item "$T\$_"}
